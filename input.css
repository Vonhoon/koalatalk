/* First, import the Tailwind directives */
@tailwind base;
@tailwind components;
@tailwind utilities;

  :root{
    --safe-top: env(safe-area-inset-top);
    --safe-bottom: env(safe-area-inset-bottom);
    --page-pad: 16px;
    --edge-gap: 10px;
    --composer-h: 140px;   /* JS updates */
    --kb: 0px;             /* JS updates */
  }

  html, body { height: 100%; overscroll-behavior: contain; }
  body{
    background:#f2f2f7; color:#111827;
    font-family: ui-rounded, system-ui, -apple-system, "SF Pro Text", Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
  }

  .topbar,.chanbar,.composer{ backdrop-filter: saturate(1.2) blur(10px); }

  /* top bars */
  .topbar{
    position: fixed; top:0; left:0; right:0; z-index:30;
    padding-top: var(--safe-top);
    background: rgba(242,242,247,.86);
    border-bottom: 1px solid rgba(0,0,0,.08);
  }
  .chanbar{
    position: fixed; left:0; right:0; top: calc(54px + var(--safe-top)); z-index:29;
    background: rgba(242,242,247,.86);
    border-bottom: 1px solid rgba(0,0,0,.06);
  }

  /* scroll area between header+channel and composer+keyboard */
  .scrollwrap{
    position: absolute; left:0; right:0;
    top: calc(54px + var(--safe-top) + 44px);
    bottom: calc(var(--composer-h) + var(--kb));
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    min-height: 0;
    overflow-anchor: auto;
  }
  /* avatars */
  .avatar{
    width:28px; height:28px; border-radius:9999px; flex:0 0 28px;
    display:inline-flex; align-items:center; justify-content:center;
    font-size:12px; font-weight:700; color:#fff; user-select:none;
  }
  /* bottom composer (slides up with keyboard) */
  .composer{
    position: fixed; left:0; right:0; bottom:0; z-index:30;
    padding-bottom: calc(8px + var(--safe-bottom));
    transform: translateY(calc(-1 * var(--kb)));
    background: rgba(242,242,247,.86);
    border-top: 1px solid rgba(0,0,0,.08);
    will-change: transform;
    transition: transform 0.2s ease;
  }

  /* === composer row === */
  #composer form#composerForm{
    display:flex; align-items:center; gap:8px;
  }
  #composer #pttBtn, #composer #addBtn{ flex:0 0 auto; }
  #composer #textInput{ flex:1 1 auto; min-width:0; }
  #composer #sendTextBtn.btn-send{
    flex:0 0 auto;
    height:40px; min-height:40px; max-height:40px;
    line-height:1; display:inline-flex; align-items:center; justify-content:center;
    padding:0 14px; white-space:nowrap; font-weight:700;
    font-size: clamp(12px, 3.6vw, 16px);
  }

  
  /* === bubbles (wider, comfy line-height) === */
  .bubble{
    box-sizing:border-box; display:inline-block;
    max-width: min(82%, calc(100vw - (var(--page-pad)*2 + var(--edge-gap)*2)));
    padding:.6rem .9rem; border-radius:1.25rem; line-height:1.5;
    box-shadow:0 1px 0 rgba(0,0,0,.04);
    word-break: keep-all; overflow-wrap: break-word; white-space: pre-wrap;
    min-width:0; margin-inline: var(--edge-gap);
    text-align:left;
  }

  /* 12자 이하 → 줄바꿈 금지(원하는 정책 유지) */
  .bubble.nowrap{
    white-space: pre;
    overflow-wrap: normal;
    word-break: keep-all;
  }
  .bubble.me{
    background:#0a84ff; color:#fff; border-bottom-right-radius:.5rem;
    margin-right: calc(var(--edge-gap) + 2px);
  }
  .bubble.other{
    background:#e9e9eb; color:#111827; border-bottom-left-radius:.5rem;
    margin-left: calc(var(--edge-gap) + 2px);
  }
  /* one-line filename inside bubbles with ellipsis */
  .bubble .file-link{
    display:inline-block;
    max-width: 260px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-decoration: underline;
    vertical-align: middle;
  }
  
  /* === tiny mic button === */
  .ptt{
    display:flex; align-items:center; justify-content:center;
    width:36px; height:36px; border-radius:9999px;
    background:#34c759; box-shadow:none;
    transition: transform .08s ease, background-color .08s ease;
    touch-action:none; user-select:none; -webkit-user-select:none; -webkit-touch-callout:none;
  }
  .ptt img{ width:18px; height:18px; pointer-events:none; }
  .ptt:active{ transform: scale(.98); }
  .ptt.recording{ background:#ff3b30; transform:none; }

  /* "+" button to match mic */
  #addBtn{
    width:36px; height:36px; border-radius:9999px;
    display:inline-flex; align-items:center; justify-content:center;
    font-weight:700; line-height:1;
    background:#fff; border:1px solid #e5e7eb;
    box-shadow:0 1px 0 rgba(0,0,0,.04);
  }
  #enableNotificationsBtn {
    display: none;
  } 
  /* day header */
  .day-header{
    display:flex; align-items:center; gap:.75rem; color:#9ca3af;
    font-size:12px; margin:10px 0; user-select:none;
  }
  .day-header::before, .day-header::after{
    content:""; flex:1; height:1px; background: rgba(0,0,0,.08);
  }

  /* channel btn */
  .channel-btn.active{ background:#0a84ff; color:#fff; }
  /* pending (optimistic) bubble */
  .bubble.pending{opacity:.85; position:relative;}
  .bubble .progress{
    display:inline-block; min-width:56px; text-align:right;
    font-size:11px; color:rgba(0,0,0,.55); margin-left:.5rem;
  }

  /* tiny spinner */
  .bubble .spinner{
    width:14px; height:14px; margin-left:.4rem; vertical-align:-2px;
    border:2px solid currentColor; border-right-color: transparent;
    border-radius:50%; display:inline-block; animation: spin .9s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* small screens: compact a bit */
  @media (max-width: 400px){
    .bubble{ max-width: calc(100% - (var(--page-pad))); padding:.45rem .6rem; }
    #composer #sendTextBtn.btn-send{ height:36px; min-height:36px; max-height:36px; padding:0 12px; font-size: clamp(12px, 3.8vw, 15px); }
    :root{ --composer-h: 122px; }
  }
